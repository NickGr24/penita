# MAIB Refund Guide - Admin Panel

## üéØ Overview
–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤–æ–∑–≤—Ä–∞—Ç—ã –ø–ª–∞—Ç–µ–∂–µ–π (refunds) –ø—Ä—è–º–æ —á–µ—Ä–µ–∑ Django Admin –ø–∞–Ω–µ–ª—å.

---

## üìã –ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å –≤–æ–∑–≤—Ä–∞—Ç –ø–ª–∞—Ç–µ–∂–∞

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "Process Refund"

1. –ó–∞–π–¥–∏—Ç–µ –≤ **Admin Panel** ‚Üí **Payments** ‚Üí **Payments**
2. –ù–∞–π–¥–∏—Ç–µ –ø–ª–∞—Ç–µ–∂, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å
3. –í –∫–æ–ª–æ–Ω–∫–µ **"Refund"** –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É **"Process Refund"**
4. –û—Ç–∫—Ä–æ–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ñ–æ—Ä–º–æ–π –≤–æ–∑–≤—Ä–∞—Ç–∞

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ Admin Action

1. –ó–∞–π–¥–∏—Ç–µ –≤ **Admin Panel** ‚Üí **Payments** ‚Üí **Payments**
2. –í—ã–±–µ—Ä–∏—Ç–µ **–æ–¥–∏–Ω** –ø–ª–∞—Ç–µ–∂ (checkbox —Å–ª–µ–≤–∞)
3. –í –≤—ã–ø–∞–¥–∞—é—â–µ–º –º–µ–Ω—é **"Action"** –≤—ã–±–µ—Ä–∏—Ç–µ **"Process refund for selected payment"**
4. –ù–∞–∂–º–∏—Ç–µ **"Go"**
5. –û—Ç–∫—Ä–æ–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ñ–æ—Ä–º–æ–π –≤–æ–∑–≤—Ä–∞—Ç–∞

---

## üí∞ –¢–∏–ø—ã –≤–æ–∑–≤—Ä–∞—Ç–∞

### Full Refund (–ü–æ–ª–Ω—ã–π –≤–æ–∑–≤—Ä–∞—Ç)
–í–µ—Ä–Ω—É—Ç—å –≤—Å—é —Å—É–º–º—É –ø–ª–∞—Ç–µ–∂–∞:
1. **–û—Å—Ç–∞–≤—å—Ç–µ –ø–æ–ª–µ "Refund Amount" –ø—É—Å—Ç—ã–º**
2. –ü–æ—Å—Ç–∞–≤—å—Ç–µ –≥–∞–ª–æ—á–∫—É –Ω–∞ "I confirm that I want to process this refund"
3. –ù–∞–∂–º–∏—Ç–µ **"Process Refund"**

### Partial Refund (–ß–∞—Å—Ç–∏—á–Ω—ã–π –≤–æ–∑–≤—Ä–∞—Ç)
–í–µ—Ä–Ω—É—Ç—å —á–∞—Å—Ç—å —Å—É–º–º—ã:
1. **–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –≤–æ–∑–≤—Ä–∞—Ç–∞** –≤ –ø–æ–ª–µ "Refund Amount"
   - –ù–∞–ø—Ä–∏–º–µ—Ä: –¥–ª—è –ø–ª–∞—Ç–µ–∂–∞ 150 MDL –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å 50 MDL
   - –ú–∞–∫—Å–∏–º—É–º: —Å—É–º–º–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞
2. –ü–æ—Å—Ç–∞–≤—å—Ç–µ –≥–∞–ª–æ—á–∫—É –Ω–∞ "I confirm that I want to process this refund"
3. –ù–∞–∂–º–∏—Ç–µ **"Process Refund"**

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –ö–æ–≥–¥–∞ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å refund:
- ‚úÖ –°—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞: **OK** (—É—Å–ø–µ—à–Ω—ã–π)
- ‚úÖ –í–æ–∑–≤—Ä–∞—Ç –µ—â–µ –Ω–µ –±—ã–ª —Å–¥–µ–ª–∞–Ω

### –ö–æ–≥–¥–∞ –ù–ï–õ–¨–ó–Ø —Å–¥–µ–ª–∞—Ç—å refund:
- ‚ùå –°—Ç–∞—Ç—É—Å: PENDING, FAIL, CANCELLED
- ‚ùå –£–∂–µ –±—ã–ª —Å–¥–µ–ª–∞–Ω –≤–æ–∑–≤—Ä–∞—Ç (status = REFUNDED)
- ‚ùå –ü–ª–∞—Ç–µ–∂ –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### –°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ MAIB:
- üîí –í–æ–∑–≤—Ä–∞—Ç –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å **—Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑**
- üìù –ü–æ—Å–ª–µ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –æ—Å—Ç–∞—Ç–∫–∞ –Ω—É–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É MAIB
- ‚ö° –í–æ–∑–≤—Ä–∞—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ —á–µ—Ä–µ–∑ MAIB API
- üîô –û–ø–µ—Ä–∞—Ü–∏—è –Ω–µ–æ–±—Ä–∞—Ç–∏–º–∞

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞:

### –í —Å–ø–∏—Å–∫–µ –ø–ª–∞—Ç–µ–∂–µ–π:
- –ö–æ–ª–æ–Ω–∫–∞ **"Refund"** –ø–æ–∫–∞–∂–µ—Ç: `‚úì Refunded: 150 MDL`
- **Status Badge** –∏–∑–º–µ–Ω–∏—Ç—Å—è –Ω–∞ —Å–∏–Ω–∏–π `REFUNDED`

### –í –¥–µ—Ç–∞–ª—è—Ö –ø–ª–∞—Ç–µ–∂–∞:
–û—Ç–∫—Ä–æ–π—Ç–µ –ø–ª–∞—Ç–µ–∂ –∏ —Ä–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ —Å–µ–∫—Ü–∏—é **"Refund Info"**:
- **Refund amount**: —Å—É–º–º–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞
- **Refund date**: –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –≤–æ–∑–≤—Ä–∞—Ç–∞

### –í –ª–æ–≥–∞—Ö:
–û—Ç–∫—Ä–æ–π—Ç–µ –ø–ª–∞—Ç–µ–∂ –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ **"Payment logs"** –≤–Ω–∏–∑—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
- –¢–∞–º –±—É–¥—É—Ç –∑–∞–ø–∏—Å–∏ –æ –∑–∞–ø—Ä–æ—Å–µ –∏ –æ—Ç–≤–µ—Ç–µ MAIB API

---

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### API Endpoint (MAIB):
```
POST https://api.maibmerchants.md/v1/refund
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:
```json
{
  "payId": "01552233-d386-4745-87c1-1894a3991474",
  "refundAmount": 50.00  // optional
}
```

### –ü–æ–ª—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (Payment model):
- `status` ‚Üí –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `REFUNDED`
- `refund_amount` ‚Üí —Å—É–º–º–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ (MDL)
- `refund_date` ‚Üí –¥–∞—Ç–∞/–≤—Ä–µ–º—è –≤–æ–∑–≤—Ä–∞—Ç–∞

---

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞: "Cannot refund payment with status: PENDING"
**–†–µ—à–µ–Ω–∏–µ**: –ü–æ–¥–æ–∂–¥–∏—Ç–µ, –ø–æ–∫–∞ –ø–ª–∞—Ç–µ–∂ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è (status = OK)

### –û—à–∏–±–∫–∞: "Payment already refunded"
**–†–µ—à–µ–Ω–∏–µ**: –≠—Ç–æ—Ç –ø–ª–∞—Ç–µ–∂ —É–∂–µ –±—ã–ª –≤–æ–∑–≤—Ä–∞—â–µ–Ω. –î–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ MAIB.

### –û—à–∏–±–∫–∞: "Refund amount cannot exceed payment amount"
**–†–µ—à–µ–Ω–∏–µ**: –í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω—É—é —Å—É–º–º–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞.

### –û—à–∏–±–∫–∞: "Failed to obtain access token"
**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ MAIB credentials –≤ `.env`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ **Admin** ‚Üí **MAIB Settings**
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è test/production mode

### –û—à–∏–±–∫–∞ –æ—Ç MAIB API
**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø–ª–∞—Ç–µ–∂–∞ (Payment logs)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ MAIB
3. –°–≤—è–∂–∏—Ç–µ—Å—å —Å —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–æ–π MAIB

---

## üìä –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π: –ö–ª–∏–µ–Ω—Ç –∫—É–ø–∏–ª –∫–Ω–∏–≥—É –∑–∞ 150 MDL, –Ω–æ –ø–µ—Ä–µ–¥—É–º–∞–ª

1. –ü–µ—Ä–µ–π—Ç–∏ –≤ Admin ‚Üí Payments ‚Üí –Ω–∞–π—Ç–∏ –ø–ª–∞—Ç–µ–∂
2. –ù–∞–∂–∞—Ç—å **"Process Refund"**
3. –û—Å—Ç–∞–≤–∏—Ç—å –ø–æ–ª–µ –ø—É—Å—Ç—ã–º (full refund)
4. –ü–æ—Å—Ç–∞–≤–∏—Ç—å –≥–∞–ª–æ—á–∫—É –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
5. –ù–∞–∂–∞—Ç—å **"Process Refund"**
6. ‚úÖ –£—Å–ø–µ—Ö: "Successfully refunded 150.0 MDL for payment b452f054..."

### –°—Ü–µ–Ω–∞—Ä–∏–π: –ß–∞—Å—Ç–∏—á–Ω—ã–π –≤–æ–∑–≤—Ä–∞—Ç 50 MDL –∏–∑ 150 MDL

1. –ü–µ—Ä–µ–π—Ç–∏ –≤ Admin ‚Üí Payments ‚Üí –Ω–∞–π—Ç–∏ –ø–ª–∞—Ç–µ–∂
2. –ù–∞–∂–∞—Ç—å **"Process Refund"**
3. –í–≤–µ—Å—Ç–∏ **50** –≤ –ø–æ–ª–µ "Refund Amount"
4. –ü–æ—Å—Ç–∞–≤–∏—Ç—å –≥–∞–ª–æ—á–∫—É –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
5. –ù–∞–∂–∞—Ç—å **"Process Refund"**
6. ‚úÖ –£—Å–ø–µ—Ö: "Successfully refunded 50.0 MDL for payment b452f054..."

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã MAIB

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º:
- **Email**: ecommerce@maib.md
- **–¢–µ–ª–µ—Ñ–æ–Ω**: +373 22 268 555
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: https://docs.maibmerchants.md/e-commerce/ro/returnare-plata

---

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MAIB API `/v1/refund`
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–ª–Ω–æ–≥–æ –∏ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—É–º–º—ã –≤–æ–∑–≤—Ä–∞—Ç–∞
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –ö—Ä–∞—Å–∏–≤—ã–π UI –≤ –∞–¥–º–∏–Ω–∫–µ
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
- ‚úÖ Real-time –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —á–µ—Ä–µ–∑ MAIB API
